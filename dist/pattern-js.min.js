!function(){window.Pattern=window.Pattern||{};var n=function(n){return this.name=n,this.class=function(n){window.Pattern[this.name]=n},this},e=function(n){return"function"==typeof n},u=function(n){return"object"==typeof n},o=function(n){return Array.isArray(n)},c=function(n,t){for(var i=0,r=n.length;i<r;i++)t(n[i])},i=function(n,t){if(u(n))for(var i in n)n.hasOwnProperty(i)&&t(n[i])},f=function(n,t,i){!function(){n.apply(t,arguments)}(i)},s=function(n,t){for(var i=0,r=n.length;i<r;i++)if(n[i]===t){n.splice(i,1),e(t.onRemove)&&t.onRemove();break}return n};n("EventSignal").class(function(){var t=[],i=function(n){e(n)&&t.push(n)};return{add:function(n){return o(n)?c(n,function(n){i(n)}):i(n),n},remove:function(n){return t=s(t,n)},dispatch:function(){c(t,function(n){n.apply(this,arguments)}.bind(this))}}}),n("Notifier").class(function(){var r=[],t=function(n){e(n.notify)&&r.push(n)};return{add:function(n){return o(n)?c(n,function(n){t(n)}):t(n),n},remove:function(n){return r=s(r,n)},notify:function(t,i){return c(r,function(n){n.notify(t,i)}),t},notifyWith:function(t){return i(t,function(n){this[n]=t[n]}.bind(this)),this}}}),n("Observable").class(function(){var r=[];return{addObserver:function(n){return u(n)&&e(n.onUpdate)?(n._observable=this,r.push(n),e(n.onRegister)&&n.onRegister(),r):n},addObservers:function(n){return c(n,function(n){this.addObserver(n)}.bind(this)),this},removeObserver:function(n){return r=s(r,n)},notifyWith:function(t){return i(t,function(n){this[n]=t[n]}.bind(this)),this},notifyObservers:function(t,i){c(r,function(n){n.onUpdate(t,i)})}}}),n("Observer").class(function(n){var t,i,r=u(t=n)?t:{};return r.onUpdate=function(n,t){return e(r[n])&&f(r[n],r,t),n},e((i=r).init)&&i.init(),r}),n("Publisher").class(function(){var r=[];return{registerSubscribers:function(n){return c(n,function(n){u(n)&&r.push(n)}),this},notifyWith:function(t){return i(t,function(n){this[n]=t[n]}.bind(this)),this},removeSubscriber:function(n){return r=s(r,n)},notify:function(t,i){return c(r,function(n){e(n[t])&&f(n[t],n,i)}),t},getSubscribers:function(){return r}}}),n("Receiver").class(function(){var i=callOnce={},r=function(n,t,i){return!n[t]&&e(i)&&(n[t]=i),n};return{on:function(n,t){return i=r(i,n,t),this},once:function(n,t){return callOnce=r(callOnce,n,t),this},notify:function(n,t){return e(callOnce[n])&&(f(callOnce[n],this,t),delete callOnce[n]),e(i[n])&&f(i[n],this,t),n}}})}();