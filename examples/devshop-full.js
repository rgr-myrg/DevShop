/**
 * Copyright (c) 2011 Roger Myrg http://devshop.me/
 * Released under the MIT license:
 * https://github.com/rgr-myrg/DevShop-JS/raw/master/MIT-LICENSE
 */
(function(b){b.DevShop=typeof b.DevShop==="object"?b.DevShop:{}})(window);(function(b){b.SingletonFactory=function(e){var c=function(a){if(typeof a==="function")try{return new a}catch(d){}else if(typeof a==="object")return a},b=c(e.implement),a=c(e.extend),c=c(e.instance),d;for(d in a)a.hasOwnProperty(d)&&(c[d]||(c[d]=a[d]));for(d in b)if(b.hasOwnProperty(d)&&!c[d])throw e.instance+" must implement '"+d+"' "+typeof b[d];if(typeof c.initialize==="function")try{c.initialize()}catch(h){}return c}})(DevShop);(function(b){b.Observable=function(e){return b.SingletonFactory({extend:function(){this.observers=[];this.addObserver=function(c){if((typeof c==="function"||typeof c==="object")&&typeof c.notify==="function")if(this.observers.push(c),typeof c.onRegister==="function")try{c.onRegister()}catch(b){}};this.notifyObservers=function(c){for(var b=this.observers.length,a=0;a<b;a++)try{this.observers[a].notify(c,this)}catch(d){}}},instance:e})}})(DevShop);(function(b){b.Observer=function(e){return b.SingletonFactory({extend:function(){this.onRegister=function(){};this.notify=function(c,b){this.observable=b;if(typeof this[c]==="function")try{this[c]()}catch(a){}}},instance:e})}})(DevShop);(function(b){b.EventSignal=function(){var b=[];this.addListener=function(c){typeof c==="function"&&b.push(c)};this.removeListener=function(c){for(var f=b.length,a=0;a<f;a++)b[a]===c&&b.splice(a)};this.dispatch=function(){for(var c=b.length,f=0;f<c;f++)try{b[f].apply(this,arguments)}catch(a){}}}})(DevShop);(function(b){b.IProxy={NAME:""};b.IMediator={NAME:"",listNotificationInterests:function(){},handleNotification:function(){}};b.ICommand={execute:function(){}};b.Proxy=function(){var b={};this.facade=null;this.setData=function(c){b=c};this.getData=function(){return b};this.onRegister=function(){};this.onRemove=function(){}};b.Mediator=b.Observer(function(){this.facade=null;this.onRegister=function(){};this.onRemove=function(){}});b.Facade=function(){var e=new function(){var a={};this.facade={};this.registerProxy=
function(d){d.facade=this.facade;a[d.NAME]||(a[d.NAME]=d);if(typeof d.onRegister==="function")try{d.onRegister()}catch(c){}};this.retrieveProxy=function(d){return a[d]?a[d]:null};this.removeProxy=function(d){if(typeof a[d].onRemove==="function")try{a[d].onRemove()}catch(c){}a[d]=null}},c=new b.Observable(function(){var a={};this.facade={};this.notification={};this.registerMediator=function(d){d.facade=this.facade;a[d.NAME]||(a[d.NAME]=d,this.addObserver(d))};this.retrieveMediator=function(d){return a[d]?
a[d]:null};this.removeMediator=function(d){if(typeof a[d].onRemove==="function")try{a[d].onRemove()}catch(c){}a[d]=null};this.notifyObservers=function(a){for(var c=this.observers.length,b=0;b<c;b++)try{for(var e=this.observers[b].listNotificationInterests(),f=!1,g=0;l=e.length,g<l;g++)if(e[g]==this.notification.name){f=!0;break}if(f)this.observers[b].notification=this.notification,this.observers[b].notify(a,this)}catch(i){}};this.sendNotification=function(a){this.notification=a;this.notifyObservers("handleNotification")}}),
f=new b.Observer(function(){var a={},c=[];this.facade={};this.NAME="DevShop.Controller";this.registerCommand=function(b,e){e.facade=this.facade;a[b]||(a[b]=e,c.push(b))};this.listNotificationInterests=function(){return c};this.handleNotification=function(){var c=this.notification;if(typeof a[c.name]==="object"&&typeof a[c.name].execute==="function")try{a[c.name].execute(c)}catch(b){}}});this.CMD_STARTUP="CMD_STARTUP";this.registerProxy=function(a){e.registerProxy(a)};this.registerMediator=function(a){c.registerMediator(a)};
this.registerCommand=function(a,c){f.registerCommand(a,c)};this.retrieveProxy=function(a){return e.retrieveProxy(a)};this.retrieveMediator=function(a){return c.retrieveMediator(a)};this.removeProxy=function(a){e.removeProxy(a)};this.removeMediator=function(a){c.removeMediator(a)};this.sendNotification=function(a,b,e){c.sendNotification({name:a,body:b,type:e})};this.initializeFacade=function(){e.facade=this;c.facade=this;f.facade=this;this.registerMediator(f)}}})(DevShop);(function(b){b.Publisher=function(){var b={};return{registerEvents:function(c){typeof c==="object"&&(b=c)},registerSubscriber:function(c){if(typeof c.onRegister==="function"){var f=c.onRegister(),a;for(a in f)f.hasOwnProperty(a)&&typeof b[a]==="object"&&b[a].addListener(f[a]);c.onRegister=function(){}}},notify:function(c,b){typeof c.dispatch==="function"&&c.dispatch(b)}}}})(DevShop);
