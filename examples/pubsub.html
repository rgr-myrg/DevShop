<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html xmlns='http://www.w3.org/1999/xhtml' lang='en' xml:lang='en:us'>
	<head>
		<meta http-equiv="Content-type" content="text/html; charset=utf-8">
		<title>DevShop.Me :: Event Signal</title>
		<style>
		</style>
		<script type="text/javascript" src="../build/1.0.0/pattern-full.js"></script>
		<script type="text/javascript">
		//Subscriber must have onRegister method that returns notification interests
		var Echo = {
			onRegister: function() {
				return {
					ON_KEYUP: this.onKeyUp
				};
			},
			onKeyUp: function( msg ){
				document.getElementById( 'echo' ).innerHTML = msg;
			}
		};
		var Mirror = {
			onRegister: function() {
				return {
					ON_KEYUP: this.onKeyUp
				};
			},
			onKeyUp:function( msg ){
				var arr = msg.split('');
				var msg = '';
				if(arr.length>0)
					for(var x=arr.length-1;x>=0;x--)
						msg+=arr[x];
				document.getElementById( 'mirror' ).innerHTML = msg;
			}
		};
		var Vertical={
			onRegister: function() {
				return {
					ON_KEYUP: this.onKeyUp
				};
			},
			onKeyUp:function( msg ) {
				var arr=msg.split('');
				var msg=arr.join('<br>');
				document.getElementById( 'vertical' ).innerHTML = msg;
			}
		};

		//Define events for your app
		var Events={
			ON_KEYUP: new Pattern.EventSignal
		};

		//Create an instance of Publisher
		var UI=new Pattern.Publisher();

		UI.registerEvents(Events);
		UI.registerSubscriber(Echo);
		UI.registerSubscriber(Mirror);
		UI.registerSubscriber(Vertical);

		UI.onKeyUp=function() {
			var data = document.getElementById('box').value;
			this.notify( Events.ON_KEYUP, data );
		};
		
		//Alternate way of 'extending' the publisher example:
		var UIx = Pattern.ObjectFactory({
			_extends_: Pattern.Publisher,
			_public_: function(){
				this.onKeyUp = function() {
					var data = document.getElementById('box').value;
					this.notify(Events.ON_KEYUP, data);
				};
				this.initialize = function() {
					this.registerEvents(Events);
					this.registerSubscriber(Echo);
					this.registerSubscriber(Mirror);
					this.registerSubscriber(Vertical);
				};
			}
		});
		</script>
	</head>
	<body>
	<form>
	<table>
		<tr>
			<td>Type in this box:</td>
			<td><input onkeyup="UI.onKeyUp()" type="text" id="box" name="box" value="" size="50"/></td>
		</tr>
		<tr>
			<td>Echo:</td><td><div id="echo"></div></td>
		</tr>
		<tr>
			<td>Mirror:</td><td><div id="mirror"></div></td>
		</tr>
		<tr>
			<td valign="top">Vertical:</td><td valign="top"><div id="vertical"></div></td>
		</tr>
	</table>
	</form>
	</body>
</html>
