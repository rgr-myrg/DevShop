/**
 * Copyright (c) 2011 Roger Myrg http://devshop.me/
 * Released under the MIT license:
 * https://github.com/rgr-myrg/DevShop-JS/raw/master/MIT-LICENSE
 */
(function(c){c.DevShop=typeof c.DevShop==="object"?c.DevShop:{}})(window);(function(c){c.SingletonFactory=function(c){var d=function(a){if(typeof a==="function")try{return new a}catch(b){}else if(typeof a==="object")return a},e=d(c.__implement),b=d(c.__extend),d=d(c.__construct),a;for(a in b)b.hasOwnProperty(a)&&(d[a]||(d[a]=b[a]));for(a in e)if(e.hasOwnProperty(a)&&!d[a])throw c.instance+" must implement '"+a+"' "+typeof e[a];if(typeof d.initialize==="function")try{d.initialize()}catch(g){}return d}})(DevShop);(function(c){c.Observable=function(c){return DevShop.SingletonFactory({__extend:function(){return{observers:[],addObserver:function(d){if((typeof d==="function"||typeof d==="object")&&typeof d.notify==="function")if(this.observers.push(d),typeof d.onRegister==="function")d.onRegister()},notifyObservers:function(d){for(var c=this.observers.length,b=0;b<c;b++)this.observers[b].notify(d,this)}}},__construct:c})}})(DevShop);(function(c){c.Observer=function(c){return DevShop.SingletonFactory({__extend:function(){return{onRegister:function(){},notify:function(c,e){this.observable=e;if(typeof this[c]==="function")try{this[c]()}catch(b){}}}},__construct:c})}})(DevShop);(function(c){c.IProxy={NAME:""};c.IMediator={NAME:"",listNotificationInterests:function(){},handleNotification:function(){}};c.ICommand={execute:function(){}};c.Proxy=function(){var c={};return{facade:null,setData:function(d){c=d},getData:function(){return c},onRegister:function(){},onRemove:function(){}}};c.Mediator=c.Observer(function(){return{facade:null,onRegister:function(){},onRemove:function(){}}});c.Facade=function(){var f=new function(){var b={};return{facade:{},registerProxy:function(a){a.facade=
this.facade;b[a.NAME]||(b[a.NAME]=a);if(typeof a.onRegister==="function")a.onRegister()},retrieveProxy:function(a){return b[a]?b[a]:null},removeProxy:function(a){if(typeof b[a].onRemove==="function")b[a].onRemove();b[a]=null}}},d=new c.Observable(function(){var b={};return{facade:{},notification:{},registerMediator:function(a){a.facade=this.facade;b[a.NAME]||(b[a.NAME]=a,this.addObserver(a))},retrieveMediator:function(a){return b[a]?b[a]:null},removeMediator:function(a){if(typeof b[a].onRemove===
"function")b[a].onRemove();b[a]=null},notifyObservers:function(a){for(var b=this.observers.length,c=0;c<b;c++){for(var d=this.observers[c].listNotificationInterests(),e=!1,f=0;l=d.length,f<l;f++)if(d[f]==this.notification.name){e=!0;break}if(e)this.observers[c].notification=this.notification,this.observers[c].notify(a,this)}},sendNotification:function(a){this.notification=a;this.notifyObservers("handleNotification")}}}),e=new c.Observer(function(){var b={},a=[];return{facade:{},NAME:"BTG.Controller",
registerCommand:function(c,d){d.facade=this.facade;b[c]||(b[c]=d,a.push(c))},listNotificationInterests:function(){return a},handleNotification:function(){var a=this.notification;typeof b[a.name]==="object"&&typeof b[a.name].execute==="function"&&b[a.name].execute(a)}}});return{CMD_STARTUP:"CMD_STARTUP",registerProxy:function(b){f.registerProxy(b)},registerMediator:function(b){d.registerMediator(b)},registerCommand:function(b,a){e.registerCommand(b,a)},retrieveProxy:function(b){return f.retrieveProxy(b)},
retrieveMediator:function(b){return d.retrieveMediator(b)},removeProxy:function(b){f.removeProxy(b)},removeMediator:function(b){d.removeMediator(b)},sendNotification:function(b,a,c){d.sendNotification({name:b,body:a,type:c})},initializeFacade:function(){f.facade=this;d.facade=this;e.facade=this;this.registerMediator(e)}}}})(DevShop);
